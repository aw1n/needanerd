{% extends "need_a_nerd_base.html" %}

{% block title %}Jobs{% endblock %}

{% block content %}
{% if jobs %}

	<form id='searchjobs'>
		<br/>
		<label for="jobsearchstr" class="control-label">Keyword Search: Search job name, employer, description, or skills (partial searches accepted)</label>
		<div class="row">	
			<div class="col-md-4">
				<p>
					<input type=text id='jobsearchstr' onkeydown=searchJobs(''+document.getElementById("jobsearchstr").value+'') placeholder="Software Engineer" />
				</p>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6">
				<button class="btn btn-primary" type=submit >Show All Jobs</button>
			</div>
		</div>
		<br />
	</form>
	<br />
	<div class="table-responsive">
	<table id='applyjobstable' class="table table-striped table-hover">
	<tr>
    	<th>Details</th>
    	<th>Name</th>
        <th>Employer</th>
        <th>Salary</th>
        <th>Apply</th>
        <th>Posting Date</th>   
	</tr>
	{% for j in jobs %}
    	<tr width="100%" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#d4e3e5';">
        	<td><button class="btn btn-primary" onclick="window.open('/jobs/{{j.pk}}/')">Show Details</button></td>
        	<td>{{j.name}}</td>
        	<td><a href='/employers/{{j.employer.userprofile_set.get.user.pk}}/'>{{j.employer.company_name}}</a></td>
        	<td>{{j.salary}}</td>
        	{% if student.userprofile.student in j.applicant.all %}
        		<td><button class="btn btn-success" id=jobid_{{j.pk}} disabled=True>Applied</button></td>
        	{% else %}
        		<td><button class="btn btn-primary" id=jobid_{{j.pk}} onClick="applyJob(jobid={{j.pk}}, studentid={{student.pk}})">Apply</button></td>
        	{% endif %}        	
        	<td>{{j.updated_at|date:'b d Y '|upper}}</td>
    	</tr>
	{% endfor %}
	</table>
	</div>
	<small>
	<p id="top10" class="text-left"></p>
	</small>
<div id="pagination" class="pagination">
<span class="step-links">
        {% if jobs.has_previous %}
            <a href="?page={{ jobs.previous_page_number }}">Previous</a>
        {% endif %}

        <span class="current">
            Page {{ jobs.number }} of {{ jobs.paginator.num_pages }}.
        </span>

        {% if jobs.has_next %}
            <a href="?page={{ jobs.next_page_number }}">Next</a>
        {% endif %}
    </span>
</div>
{% else %}
    There are no students listed in the database.
{% endif %}
{% endblock %}
